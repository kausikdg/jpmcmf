'use strict';

const S3270 = require('..');
const fs = require('fs');

const terminal = S3270.connect('fandezhi.efglobe.com');

terminal.status().then((status) => { console.log(JSON.stringify(status)) });

terminal.readScreen().then((screen) => {
    let field = screen.editableFieldAfterText("Enter your choice==>");  
    field.setValue("TSO");
    return terminal.applyScreen(screen);
}).then(() => {
    return terminal.sendCommand("enter");
}).then(() => {
    return terminal.sendCommand("wait(InputField)");
}).then(() => {
    return terminal.readScreen();
}).then((screen) => {
    let field = screen.editableFieldAfterText("IKJ56700A ENTER USERID -");
    field.setValue("PRASV");
    return terminal.applyScreen(screen);
}).then(() => {
    return terminal.sendCommand("enter");
}).then(() => {
    return terminal.sendCommand("wait(InputField)");
}).then(() => {
    return terminal.sendCommand("ascii").then((ascii) => { console.log(ascii) });
}).then(() => {
    return terminal.readScreen();
}).then((screen) => {
    console.log(screen.printFields());
    let field = screen.editableFieldAfterText(" Password  ===>");
    field.setValue("P@55word");
    return terminal.applyScreen(screen);
}).then(() => {
    return terminal.sendCommand("enter");
}).then(() => {
    return terminal.sendCommand("wait(InputField)");
}).then(() => {
    return terminal.sendCommand("ascii").then((ascii) => { console.log(ascii) });
})