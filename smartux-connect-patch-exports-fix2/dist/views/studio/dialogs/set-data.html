<div class="heading" ng-hide="mapInput || mapOutput">
    <h1>
        Set Data
    </h1>
</div>

<div class="heading" ng-show="mapInput || mapOutput">
        <h1>
            API Data
        </h1>
        <div class="tab" ng-click="inputTab()" ng-class="{'selected': selectedTab.tab === 'input'}" ng-if="inputsTree && (outputsTree || errorOutputsTree)">
            <i class="fa fa-cube"></i>
            <h3>Input</h3>
        </div>
        <div class="tab" ng-click="outputTab()" ng-class="{'selected': selectedTab.tab === 'output'}" ng-if="outputsTree || errorOutputsTree">
            <i class="fa fa-code"></i>
            <h3>Output</h3>
        </div>
    </div>


<div class="content">
    <div class="row from-to-headers">
        <div class="col col-xs-6">
            <h2>To:</h2>
        </div>
        <div class="col col-xs-6">
            <h2>From:</h2>
        </div>
    </div>
    <div class="row">
        <!-- Set Data and Output mapping left side -->
        <!-- Screen Model Tree -->
        <div class="col col-xs-6" ng-hide="mapInput">
            <div class="box-nested left">

                <ul class="tree screen-model" ng-if="ngDialogData.block.type !== 'transform' && !customInputTree">
                    <li collapsible>
                        <input class="marker" type="checkbox" checked="checked">
                        <label class="target"></label>
                        <span class="item">
                            <i class="fa fa-cogs"></i>
                            {{ngDialogData.block.type === 'screen' ? 'Screen Model' : 'Screen Models'}}
                        </span>
                        <ul class="content" screen-model-tree options="leftModelTreeOptions" tree-root>
                            <li ng-repeat="model in leftScreenModelTree" tree-node="model" collapsible>
                            </li>
                        </ul>
                    </li>
                </ul>

                <ul class="tree page-model" ng-if="ngDialogData.block.type === 'transform' && !customInputTree">
                    <li collapsible>
                        <input class="marker" type="checkbox" checked="checked">
                        <label class="target"></label>
                        <span class="item">
                            <i class="fa fa-cogs"></i>
                            Page Model
                        </span>
                        <ul class="content" screen-model-tree options="leftPageModelTreeOptions" tree-root>
                            <li tree-node="leftPageModel" collapsible>
                            </li>
                        </ul>
                    </li>
                </ul>

                <!-- Set Variable -->
                <details open ng-if="!customInputTree">
                    <summary>Variables</summary>
                    <div class="set-variable">
                        <div class="title">
                            <span class="title-right" ng-click="addNewVariable()">
                                <span>+</span>
                                    Add New
                            </span>
                        </div>

                        <div ng-repeat="variable in toVariables">
                            <div class="custom-radio">
                                <input type="radio" ng-change="LHSVariable(variable)" ng-model="lhsValues.radioSelection" value="variables.{{variable.scope}}.{{variable.name}}" id="lhs{{variable.name}}" name="lhsRadio">
                                <label for="lhs{{variable.name}}"></label>
                                <input type="text" class="var-name" placeholder="Variable name" ng-model="variable.name" ng-focus="selectLhsVar(variable); LHSVariable(variable)" ng-change="selectLhsVar(variable); LHSVariable(variable, '{{variable.name}}')">
                                <div class="custom-dropdown">
                                    <select class="var-descriptions" ng-options="item.value as item.name for item in variableScopes" ng-model="variable.scope" ng-focus="selectLhsVar(variable); LHSVariable(variable)">
                                    </select>
                                </div>
                                <button ng-click="deleteVariable($index)">-</button>
                            </div>
                            <div class="associatedItem" ng-click="setSelectedString" ng-if="currentMap[variable.key].selectedString">
                                <p>{{currentMap[variable.key].selectedString}}
                                    <span ng-click="removeAssociation(variable.key, $event)" class="delete fa-trash-o"></span>
                                </p>
                            </div>
                        </div>
                    </div>
                </details>

                <ul class="tree user-info content" ng-if="customInputTree" options="customInputTreeOptions" tree-root>
                    <li tree-node="customInputObject" collapsible>
                    </li>
                </ul>

            </div>
        </div>

        <!-- Left side for mapping inputs -->
        <!-- Input Tree -->
        <div class="col col-xs-6" ng-show="mapInput">
            <div class="box-nested no-padding-left">
                <ul class="tree">
                    <li collapsible>
                        <input class="marker" type="checkbox" checked="checked">
                        <label class="target"></label>
                        <span ng-if="inputsTree" class="item">
                            Block Data
                        </span>
                        <ul class="content" block-data-tree options="inputTreeOptions" tree-root>
                            <li ng-repeat="prop in inputsTree" tree-node="prop" collapsible></li>
                        </ul>
                    </li>
                </ul>
            </div>
        </div>

        <!-- Set data and input mapping right side -->
        <!-- right -->
        <div class="col col-xs-6" ng-show="!mapOutput">
            <div class="box-nested right">
                <ul class="tree page-model" ng-if="hasTransformEvent" ng-repeat="(explorerId, models) in pageModelTrees">
                    <li collapsible>
                        <input class="marker" type="checkbox" checked="checked">
                        <label class="target"></label>
                        <span class="item">
                            <i class="fa fa-cogs"></i>
                            {{explorerId}} - Page Models
                        </span>
                        <ul class="content" options="pageModelTreeOptions" tree-root>
                            <li ng-repeat="model in models" tree-node="model" collapsible>
                            </li>
                        </ul>
                    </li>
                </ul>
                <ul class="tree screen-model-item" ng-if="hasItemEvent">
                    <li collapsible>
                        <input class="marker" type="checkbox" checked="checked">
                        <label class="target"></label>
                        <span class="item" ng-click="itemClick()" ng-style="itemStyle" ng-mouseenter="changeItemStyle()" ng-mouseleave="changeItemStyleBack()">
                            <i class="fa fa-cogs"></i>
                            Item
                        </span>
                        <ul class="content" options="itemTreeOptions" tree-root>
                            <li ng-repeat="prop in itemTree" tree-node="prop" collapsible>
                            </li>
                        </ul>
                    </li>
                </ul>
                <ul class="tree screen-model">
                    <li collapsible>
                        <input class="marker" type="checkbox" checked="checked">
                        <label class="target"></label>
                        <span class="item">
                            <i class="fa fa-cogs"></i>
                            Screen Models
                        </span>
                        <ul class="content" screen-model-tree options="rightModelTreeOptions" tree-root>
                            <li ng-repeat="model in rightScreenModelTree" tree-node="model" collapsible>
                            </li>
                        </ul>
                    </li>
                </ul>

                <!-- previous block outputs -->
                <ul class="tree outputs-tree">
                    <li collapsible>
                        <input class="marker" type="checkbox" checked="checked">
                        <label class="target"></label>
                        <span ng-if="previousOutputsTree" class="item">
                            Previous outputs
                        </span>
                        <ul class="content" block-data-tree options="previousOutputTreeOptions" tree-root>
                            <li ng-repeat="prop in previousOutputsTree" tree-node="prop" collapsible></li>
                        </ul>
                    </li>
                </ul>

                <!-- item tree -->
                <ul class="tree">
                    <li collapsible>
                        <input class="marker" type="checkbox" checked="checked">
                        <label class="target"></label>
                        <span ng-if="items" class="item">
                            Item
                        </span>
                        <ul class="content" block-data-tree options="itemTreeOptions" tree-root>
                            <li ng-repeat="prop in items" tree-node="prop" collapsible></li>
                        </ul>
                    </li>
                </ul>

                <!-- start tree -->
                <ul class="tree">
                    <li collapsible>
                        <input class="marker" type="checkbox" checked="checked">
                        <label class="target"></label>
                        <span ng-if="start" class="item">
                            Start
                        </span>
                        <ul class="content" block-data-tree options="startTreeOptions" tree-root>
                            <li ng-repeat="prop in start" tree-node="prop" collapsible></li>
                        </ul>
                    </li>
                </ul>

                <!-- page model tree -->
                <ul class="tree">
                    <li collapsible>
                        <input class="marker" type="checkbox" checked="checked">
                        <label class="target"></label>
                        <span ng-if="pagemodels" class="item">
                            Page Model
                        </span>
                        <ul class="content" block-data-tree options="pagemodelTreeOptions" tree-root>
                            <li ng-repeat="prop in pagemodels" tree-node="prop" collapsible></li>
                        </ul>
                    </li>
                </ul>

                <!-- Set Variable -->
                <details open>
                    <summary>Variables</summary>
                    <div class="set-variable">
                        <div class="title">
                            <span class="title-right" ng-click="addNewVariable()">
                                <span class="addIcon">+</span>
                                    Add New
                            </span>
                        </div>

                        <div ng-repeat="variable in fromVariables">
                            <div class="custom-radio">
                                <input type="radio" ng-change="RHSVariable(currentMap[selectedProp.id], variable)" ng-model="rhsValues.radioSelection" value="{{'variables.' + variable.scope + '.' + variable.name}}" id="{{'var.' + variable.name}}" name="rhsRadio">
                                <label for="{{'var.' + variable.name}}"></label>
                                <!-- name -->
                                <input type="text" placeholder="Variable name" ng-model="variable.name" ng-focus="selectRhsVar(variable); RHSVariable(currentMap[selectedProp.id], variable)">
                                <!-- scope -->
                                <div class="custom-dropdown">
                                    <select ng-options="item.value as item.name for item in variableScopes" ng-model="variable.scope" ng-focus="selectRhsVar(variable); RHSVariable(currentMap[selectedProp.id], variable)">
                                    </select>
                                </div>
                                <button ng-click="deleteVariable($index)">-</button>
                            </div>
                        </div>
                    </div>
                </details>

                <!-- constant -->
                <details open>
                    <summary>Constant</summary>
                    <div class="set-constant">
                        <div class="custom-radio">
                            <input type="radio" id="constant" ng-model="selectedProp.selectedType" value="constant" name="rhsRadio">
                            <label for="constant"></label>
                        </div>
                        <input type="text" placeholder="Create a constant" ng-change="selectConstant(currentMap[ngDialogData.block.type === 'transform' && selectedProp.toType === 'input' ? selectedProp.path : selectedProp.id])" ng-model="currentMap[ngDialogData.block.type === 'transform' && selectedProp.toType === 'input' ? selectedProp.path : selectedProp.id].constant" ng-focus="selectRadio('constant')">
                    </div>
                </details>

                <!-- Set Expression-->
                <details open ng-if="!mapOutput">
                    <summary>Expression</summary>
                    <div class="set-expression">
                        <div class="custom-radio">
                            <input type="radio" id="expression" ng-model="selectedProp.selectedType" value="expression" name="rhsRadio">
                            <label for="expression"></label>
                        </div>
                        <input type="text" placeholder="Create an expression" ng-change="selectExpression(currentMap[ngDialogData.block.type === 'transform' && selectedProp.toType === 'input' ? selectedProp.path : selectedProp.id])" ng-model="currentMap[ngDialogData.block.type === 'transform' && selectedProp.toType === 'input' ? selectedProp.path : selectedProp.id].expression" ng-focus="selectRadio('expression')">
                    </div>
                </details>

            </div>
            <!-- /box-nested -->
        </div>

        <!-- right side for mapping outputs -->
        <div class="col col-xs-6" ng-show="mapOutput">
            <div class="box-nested no-padding-left">

                <!-- Output Tree -->
                <ul class="tree">
                    <li collapsible>
                        <input class="marker" type="checkbox" checked="checked">
                        <!-- <label class="target"></label> -->
                        <!-- <span ng-if="outputsTree" class="item">
                            Block Data
                        </span> -->
                        <ul class="content" block-data-tree options="outputTreeOptions" tree-root>
                            <li ng-repeat="prop in outputsTree" tree-node="prop" collapsible></li>
                        </ul>
                    </li>
                </ul>


                <!-- previous block outputs -->
                <ul class="tree outputs-tree">
                    <li collapsible>
                        <input class="marker" type="checkbox" checked="checked">
                        <label class="target"></label>
                        <span ng-if="previousOutputsTree" class="item">
                            Previous outputs
                        </span>
                        <ul class="content" block-data-tree options="previousOutputTreeOptions" tree-root>
                            <li ng-repeat="prop in previousOutputsTree" tree-node="prop" collapsible></li>
                        </ul>
                    </li>
                </ul>

                <!-- error outputs -->
                <ul class="tree outputs-tree">
                    <ul class="content" block-data-tree options="errorOutputTreeOptions" tree-root>
                        <li ng-repeat="prop in errorOutputsTree" tree-node="prop" collapsible></li>
                    </ul>
                </ul>

                <!-- Set Expression -->
                <details ng-if="mapOutput">
                    <summary>Expression</summary>
                    <div class="set-expression">
                        <div class="custom-radio">
                            <input type="radio" id="expression" ng-model="selectedProp.selectedType" value="expression" name="rhsRadio">
                            <label for="outputExp"></label>
                        </div>
                        <input type="text" placeholder="Create an expression" ng-change="selectExpression(currentMap[selectedProp.id])" ng-model="currentMap[selectedProp.id].expression" ng-focus="selectRadio('expression')">
                    </div>
                </details>
            </div>
        </div>
            <!-- /right side of mapping output -->
    </div>
</div>

<div class="buttons">
    <button class="button" ng-click="apply()">
        Apply
    </button>
    <button class="button clear" ng-click="close()">
        Close
    </button>

</div>
